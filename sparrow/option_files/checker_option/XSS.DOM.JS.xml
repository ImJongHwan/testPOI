<?xml version="1.0" encoding="utf-8"?>
<option>
    <category name="XSS.DOM.JS">
        <item name="taint_source" type="string" required="true" variable="true" regexp="true">
            <value>document\.URL$variable</value>
            <value>document\.URL\..+$return</value>
            <value>document\.documentURI$variable</value>
            <value>document\.documentURI\..+$return</value>
            <value>document\.URLUnencoded$variable</value>
            <value>document\.URLUnencoded\..+$return</value>
            <value>document\.baseURI$variable</value>
            <value>document\.baseURI\..+$return</value>
            <value>document\.cookie$variable</value>
            <value>document\.cookie\..+$return</value>
            <value>document\.referrer$variable</value>
            <value>document\.referrer\..+$return</value>
            <value>location\.hash$variable</value>
            <value>location\.hash\..+$return</value>
            <value>.+\.location\.hash$variable</value>
            <value>.+\.location\.hash\..+$return</value>
            <value>location\.href$variable</value>
            <value>location\.href\..+$return</value>
            <value>.+\.location\.href$variable</value>
            <value>.+\.location\.href\..+$return</value>
            <value>taint_.*XSS\.DOM\.JS.*P_A_[0-9]+$variable</value>
            <value>decodeURIComponent$return</value> <!-- if param was executed by function encodeURIComponent-->
            <value>__sparrow_node_js_request__\.url$variable</value>
        </item>
        <item name="taint_sink" type="string" required="true" variable="true" regexp="true">
            <value>document\.write$param(*)</value>
            <value>document\.writeln$param(*)</value>
            <value>document\.location\.replace$param(*)</value>
            <value>eval$param(*)</value>
            <value>.+\.exec$param(1)</value>
            <value>Function$param(*)</value>
            <value>setTimeout$param(*)</value>
            <value>location.assign$param(1)</value>
            <value>location.replace$param(1)</value>
            <!-- Sink added -->
            <value>alert$param(*)</value>
            <value>crypto\.generateCRMFRequest$param(5)</value>
            <value>.+\.createContextualFragment$param(1)</value>
            <value>operand(2) of "=" if operand(1) == reg(".+\.innerHTML")</value>
            <value>operand(2) of "=" if operand(1) == reg(".+\.outerHTML")</value>
            <value>__sparrow_node_js_response__\.end$param(1)</value>
        </item>
        <item name="taint_propagator" type="string" required="false" variable="true" regexp="true">
            <value>\+$operand(*)->return</value>
        </item>
        <item name="taint_filter" type="string" required="false" variable="true" regexp="true">
            <value>encodeURIComponent$return</value>
        </item>
    </category>
</option>
